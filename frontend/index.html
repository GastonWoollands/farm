<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#0f766e">
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="icons/icon-192.jpg" sizes="192x192">
  <link rel="apple-touch-icon" href="icons/icon-192.jpg">
  <link rel="stylesheet" href="styles.css">
  <title>Farm Register</title>
</head>
<body>
  <header class="app-header">
    <h1>Farm Register <small id="pending-count" class="muted" style="font-size:12px; margin-left:8px;"></small></h1>
    <span class="badge" id="status-badge">Offline</span>
  </header>

  <main class="container" id="auth-screen" hidden>
    <section class="card">
      <h2>Enter User Key</h2>
      <p class="muted">Provided by your system administrator</p>
      <form id="key-form">
        <label for="user-key">User key</label>
        <div class="row gap" style="align-items:center;">
          <input id="user-key" name="user-key" type="password" placeholder="••••-••••-••••" required autocomplete="off" style="flex:1;">
          <button type="button" id="toggle-key" class="btn" aria-label="Show key">Show</button>
        </div>
        <button type="submit" class="btn primary" style="margin-top:8px;">Continue</button>
        <p id="key-error" class="error" role="alert" hidden>Invalid key. Please try again.</p>
        <pre id="key-debug" class="muted" style="white-space:pre-wrap; overflow:auto; margin-top:8px;" hidden></pre>
      </form>
    </section>
  </main>

  <main class="container" id="app-screen" hidden>
    <section class="card">
      <div class="row space-between align-center">
        <h2>Livestock</h2>
        <div class="row gap">
          <button id="register-btn" class="btn primary">Register New</button>
          <button id="manage-synced" class="btn">Manage registers…</button>
          <button id="export-json" class="btn">Export JSON</button>
          <button id="export-csv" class="btn">Export CSV</button>
        </div>
      </div>

      <section id="register-section" hidden>
        <form id="inline-add" class="form-vertical" style="margin:8px 0 12px;">
          <div class="form-field">
            <label for="inline-animal">Livestock ID</label>
            <input id="inline-animal" type="text" inputmode="numeric" placeholder="e.g., 12345" autocomplete="off" required>
          </div>
          <div class="form-field">
            <label for="inline-mother">Mother ID (optional)</label>
            <input id="inline-mother" type="text" inputmode="numeric" placeholder="e.g., 67890" autocomplete="off">
          </div>
          <div class="form-field">
            <label for="inline-born">Born date (optional)</label>
            <input id="inline-born" type="date" autocomplete="off">
          </div>
          <div class="form-field">
            <label for="inline-weight">Weight (kg, optional)</label>
            <input id="inline-weight" type="number" step="0.01" min="0" placeholder="e.g., 250.5" autocomplete="off">
          </div>
          <div class="form-field">
            <label for="inline-gender">Gender (optional)</label>
            <select id="inline-gender">
              <option value="">— Select —</option>
              <option value="male">Male</option>
              <option value="female">Female</option>
              <option value="unknown">Unknown</option>
            </select>
          </div>
          <div class="form-field">
            <label for="inline-status">Status (optional)</label>
            <select id="inline-status">
              <option value="">— Select —</option>
              <option value="alive">Alive</option>
              <option value="dead">Dead</option>
              <option value="unknown">Unknown</option>
            </select>
          </div>
          <div class="form-field">
            <label for="inline-color">Color (optional)</label>
            <input id="inline-color" type="text" placeholder="e.g., brown/black" autocomplete="off">
          </div>
          <div class="form-field">
            <label for="inline-notes-mother">Mother notes (optional)</label>
            <input id="inline-notes-mother" type="text" placeholder="Any notes about the mother" autocomplete="off">
          </div>
          <div class="form-field">
            <label for="inline-notes">Notes (optional)</label>
            <input id="inline-notes" type="text" placeholder="Any notes" autocomplete="off">
          </div>
          <div class="row gap">
            <button class="btn primary" id="inline-add-btn" type="submit" aria-label="Register livestock">Register</button>
          </div>
        </form>
      </section>

      <ul id="records" class="list"></ul>
    </section>
  </main>

  <footer class="footer">
    <small>
      Status: <span id="sync-status">Idle</span>
      • API: <code id="api-base"></code>
    </small>
  </footer>

  <script type="module" src="app.js"></script>
  <div id="toast" role="status" aria-live="polite" hidden></div>
  <dialog id="manage-synced-dialog">
    <div class="row space-between align-center">
      <h3 style="margin:0;">Manage Synced Records</h3>
      <form method="dialog">
        <button class="btn" value="close">Close</button>
      </form>
    </div>
    <ul id="manage-synced-list" class="list" style="margin-top:8px;"></ul>
  </dialog>
</body>
</html>

