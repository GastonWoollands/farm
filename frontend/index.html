<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#0f766e">
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="icons/icon-192.jpg" sizes="192x192">
  <link rel="apple-touch-icon" href="icons/icon-192.jpg">
  <link rel="stylesheet" href="styles.css">
  <title>Registro de Animales</title>
  <script defer src="/_vercel/insights/script.js"></script>
  <script defer src="/_vercel/speed-insights/script.js"></script>
</head>
<body>
  <header class="app-header">
    <h1>Registro de Animales <small id="pending-count" class="muted" style="font-size:12px; margin-left:8px;"></small></h1>
    <span class="badge" id="status-badge">Offline</span>
  </header>

  <main class="container" id="auth-screen" hidden>
    <section class="card">
      <h2>Ingresar clave de usuario</h2>
      <p class="muted">Proporcionada por el administrador del sistema</p>
      <form id="key-form">
        <label for="user-key">Clave de usuario</label>
        <div class="row gap" style="align-items:center;">
          <input id="user-key" name="user-key" type="password" placeholder="••••-••••-••••" required autocomplete="off" style="flex:1;">
          <button type="button" id="toggle-key" class="btn" aria-label="Show key">Show</button>
        </div>
        <button type="submit" class="btn primary" style="margin-top:8px;">Continuar</button>
        <p id="key-error" class="error" role="alert" hidden>Clave inválida. Intente nuevamente.</p>
        <pre id="key-debug" class="muted" style="white-space:pre-wrap; overflow:auto; margin-top:8px;" hidden></pre>
      </form>
    </section>
  </main>

  <main class="container" id="app-screen" hidden>
    <section class="card">
      <div class="row space-between align-center">
      <h2>Animales</h2>
        <div class="row gap">
          <button id="register-btn" class="btn primary">Registrar Nuevo</button>
          <button id="manage-synced" class="btn">Gestionar registros…</button>
          <button id="export-csv" class="btn">Exportar CSV</button>
        </div>
      </div>

      <section id="register-section" hidden>
        <form id="inline-add" class="form-vertical" style="margin:8px 0 12px;">
          <div class="form-field">
            <label for="inline-animal">ID (requerido)</label>
            <input id="inline-animal" type="text" placeholder="e.g., A123-45" autocomplete="off" required>
          </div>
          <div class="form-field">
            <label for="inline-mother">Madre ID (opcional)</label>
            <input id="inline-mother" type="text" placeholder="e.g., 67890" autocomplete="off">
          </div>
          <div class="form-field">
            <label for="inline-born">Nacimiento (opcional)</label>
            <input id="inline-born" type="text" inputmode="numeric" placeholder="dd/mm/aaaa" autocomplete="off">
          </div>
          <div class="form-field">
            <label for="inline-weight">Peso (kg, opcional)</label>
            <input id="inline-weight" type="number" step="0.01" min="0" placeholder="e.g., 250.5" autocomplete="off">
          </div>
          <div class="form-field">
            <label for="inline-gender">Sexo (opcional)</label>
            <select id="inline-gender">
              <option value="">— Seleccionar —</option>
              <option value="MALE">Male</option>
              <option value="FEMALE">Female</option>
              <option value="UNKNOWN">Unknown</option>
            </select>
          </div>
          <div class="form-field">
            <label for="inline-status">Estado (opcional)</label>
            <select id="inline-status">
              <option value="">— Seleccionar —</option>
              <option value="ALIVE">Alive</option>
              <option value="DEAD">Dead</option>
              <option value="UNKNOWN">Unknown</option>
            </select>
          </div>
          <div class="form-field">
            <label for="inline-color">Color (opcional)</label>
            <select id="inline-color">
              <option value="">— Seleccionar —</option>
              <option value="COLORADO">Colorado</option>
              <option value="MARRON">Marron</option>
              <option value="NEGRO">Negro</option>
              <option value="OTHERS">Others</option>
            </select>
          </div>
          <div class="form-field">
            <label for="inline-notes-mother">Notas de la madre (opcional)</label>
            <input id="inline-notes-mother" type="text" placeholder="Cualquier nota sobre la madre" autocomplete="off">
          </div>
          <div class="form-field">
            <label for="inline-notes">Notas (opcional)</label>
            <input id="inline-notes" type="text" placeholder="Cualquier nota" autocomplete="off">
          </div>
          <div class="row gap">
            <button class="btn primary" id="inline-add-btn" type="submit" aria-label="Registrar animal">Registrar</button>
          </div>
        </form>
      </section>

      <ul id="records" class="list"></ul>
    </section>
  </main>

  <footer class="footer">
    <small>
      Status: <span id="sync-status">Idle</span>
      • API: <code id="api-base"></code>
    </small>
  </footer>

  <script type="module" src="app/main.js"></script>
  <div id="toast" role="status" aria-live="polite" hidden></div>
  <dialog id="manage-synced-dialog">
    <div class="row space-between align-center">
      <h3 style="margin:0;">Gestionar registros sincronizados</h3>
      <form method="dialog">
        <button class="btn" value="close">Cerrar</button>
      </form>
    </div>
    <ul id="manage-synced-list" class="list" style="margin-top:8px;"></ul>
  </dialog>
  <dialog id="export-dialog">
    <form method="dialog" class="form-vertical">
      <h3 style="margin:0 0 8px 0;">Exportar por fecha de nacimiento</h3>
      <div class="row gap" style="align-items:center;">
        <label class="muted" for="export-start-modal">Desde</label>
        <input id="export-start-modal" type="date" aria-label="Desde fecha de nacimiento" />
        <label class="muted" for="export-end-modal">Hasta</label>
        <input id="export-end-modal" type="date" aria-label="Hasta fecha de nacimiento" />
      </div>
      <div class="row gap" style="margin-top:12px; justify-content:flex-end;">
        <button class="btn" value="cancel" id="export-cancel">Cancelar</button>
        <button class="btn primary" value="confirm" id="export-confirm">Exportar</button>
      </div>
    </form>
  </dialog>
</body>
</html>

